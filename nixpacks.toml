# Railway deployment configuration - API only
# The web package is deployed separately on Vercel

[phases.install]
cmds = ["npm ci --ignore-scripts"]

[phases.build]
cmds = [
  "npm run build -w @halcyon-rcm/core",
  "npm run build -w @halcyon-rcm/file-exchange",
  "cd packages/api && npx prisma generate",
  "npm run build -w @halcyon-rcm/api"
]

[start]
cmd = "cd packages/api && echo 'Running prisma db push...' && npx prisma db push --skip-generate --accept-data-loss 2>&1 && echo 'Prisma db push completed' && npm start"
