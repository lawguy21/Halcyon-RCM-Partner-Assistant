# Railway deployment configuration - API only
# The web package is deployed separately on Vercel

[phases.install]
cmds = ["npm ci --ignore-scripts"]

[phases.build]
cmds = [
  "npm run build -w @halcyon-rcm/core",
  "npm run build -w @halcyon-rcm/file-exchange",
  "cd packages/api && npx prisma generate",
  "npm run build -w @halcyon-rcm/api",
  "cd packages/api && npx prisma db push --skip-generate --accept-data-loss || echo 'Note: prisma db push will run at startup'"
]

[start]
cmd = "cd packages/api && node init-db.mjs"
